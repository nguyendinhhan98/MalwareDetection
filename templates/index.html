<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <title>Malware Detection</title>
<!--    <link rel="shortcut icon" href="/img/aa.jpg"/>-->
    <!-- Google font -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CVarela+Round" rel="stylesheet">

    <!-- Bootstrap -->
    <link type="text/css" rel="stylesheet" href="/static/css/bootstrap.min.css"/>

    <!-- Owl Carousel -->
    <link type="text/css" rel="stylesheet" href="/static/css/owl.carousel.css"/>
    <link type="text/css" rel="stylesheet" href="/static/css/owl.theme.default.css"/>

    <!-- Magnific Popup -->
    <link type="text/css" rel="stylesheet" href="/static/css/magnific-popup.css"/>

    <!-- Font Awesome Icon -->
    <link rel="stylesheet" href="/static/css/font-awesome.min.css"/>

    <!-- Custom stlylesheet -->
    <link type="text/css" rel="stylesheet" href="/static/css/style.css"/>

    <!-- FOR UPLOAD BUTTON -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel='stylesheet prefetch' href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css'>
    <link rel='stylesheet prefetch' href='https://fonts.googleapis.com/css?family=Roboto:100,300'>
    <link rel="stylesheet" href="/static/css/styles.css">
    <!--FINISH-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    {% if algorithms %}
    <script type="text/javascript">
        strDataGraph = '{{algorithms|tojson}}'
        dataGraph = JSON.parse(strDataGraph)
  		google.charts.load("current", {packages:['corechart']});
    	google.charts.setOnLoadCallback(drawChart);
    	function drawChart() {
    	    var array = [["Element", "Density", { role: "style" } ]]
            var arrayColor = ['rgb(153, 0, 153)', 'rgb(51, 102, 204', 'rgb(16, 150, 24)', 'rgb(255, 153, 0', 'rgb(220, 57, 18)']
            var i = 0;
    	    for (let [key, value] of Object.entries(dataGraph)) {
                array.push([`${key}`, parseFloat(`${value}`), arrayColor[i]])
                i++;
            };
			var data = google.visualization.arrayToDataTable(array)
			var view = new google.visualization.DataView(data);
			view.setColumns([0, 1,
                       { calc: "stringify",
                         sourceColumn: 1,
                         type: "string",
                         role: "annotation" },
                       2]);
			var options = {
				title: "",
				width: 1400,
				height: 600,
				bar: {groupWidth: "55%"},
				legend: { position: "none" },

			};
			var chart = new google.visualization.ColumnChart(document.getElementById("id_graph"));
			chart.draw(view, options);
        }
    </script>
    {% endif %}
</head>

<body>
<!-- Header -->
<header id="home">
    <!-- Background Image -->
<!--    <div class="bg-img" style="background-image: url('./static/img/background1.jpg');">-->
<!--        <div class="overlay"></div>-->
<!--    </div>-->
<!--    <div class="bg">-->
<!--        <img src="./static/img/background1.jpg" ></img>-->
<!--    </div>-->

    <nav class="navbar nav-transparent">
        <div class="container">

            <div class="navbar-header">
                <!-- Logo -->
                <div class="navbar-brand">
                    <br>
                    <a href="/">
                        <h3 style="color:white;" class="logo-alt">MALWARE DETECTION</h3>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="row">
             <!-- home content -->
            <div class="">
                 <center><br><br><br>
                <div class="upload">
                    <form action="/" method="POST" enctype="multipart/form-data" id="myFile">
                        <div class="upload-files">
                            <header>
                                <p>
                                    <i class="fa fa-cloud-upload" aria-hidden="true"></i>
                                    <span class="up">up</span>
                                    <span class="load">load</span>
                                </p>
                            </header>
                            <div class="body" id="drop">
                                <i class="fa fa-file-text-o pointer-none" aria-hidden="true"></i>
                                <p class="pointer-none"><b>Drag and drop</b> files here <br/> or <a href=""
                                                                                                    id="triggerFile">browse</a>
                                    to begin the upload</p>
                                <input type="file" name="file" multiple="multiple"/>
                            </div>
                            <footer>
                                <div class="divider">
                                    <span><AR>FILES</AR></span>
                                </div>
                                <div class="list-files">
                                    <!--   template   -->
                                </div>
                                <button class="importar">Start Detection</button>
                            </footer>
                        </div>
                    </form>
                </div>
            </center>
            </div>

            <!-- /home content -->
        </div></div>

</header>
    <div>
     {% if result %}
    <div style="margin-left:400px">
        <h1 style="color: red;  font-family: 'Google Sans, Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size:47px"> <div class="boxShadow" style="margin-left:280px" id="malicious"></div></h1>
        <h1 style="color: green;  font-family: 'Google Sans, Roboto, RobotoDraft, Helvetica, Arial, sans-serif; font-size:47px"> <div class="boxShadow" style="margin-left:280px" id="legitimate"></div></h1>
        <span>Names</span>
        <table class="table" style="width:300px">
            <tbody id="name"></tbody>
        </table>
        <br />

        <span>Basic Properties</span>
        <table class="table" style="width:300px">
            <tbody>
            <tr>
                <td>MD5</td>
                <td>{{result.data.attributes.md5}}</td>
            </tr>
            <tr>
                <td>SHA-1</td>
                <td>{{result.data.attributes.sha1}}</td>
            </tr>
            <tr>
                <td>SHA-256</td>
                <td>{{result.data.attributes.sha256}}</td>
            </tr>
            <tr>
                <td>Vhash</td>
                <td>{{result.data.attributes.vhash}}</td>
            </tr>
            <tr>
                <td>Authentihash</td>
                <td>{{result.data.attributes.authentihash}}</td>
            </tr>
            <tr>
                <td>Imphash</td>
                <td>{{result.data.attributes.pe_info.imphash}}</td>
            </tr>
            <tr>
                <td>SSDEEP</td>
                <td>{{result.data.attributes.ssdeep}}</td>
            </tr>
            <tr>
                <td>File type</td>
                <td>{{result.data.attributes.type_description}}</td>
            </tr>
            <tr>
                <td>Magic</td>
                <td>{{result.data.attributes.magic}}</td>
            </tr>
            <tr>
                <td>File size</td>
                <td>{{result.data.attributes.size}}(bytes)</td>
            </tr>
            </tbody>
        </table>

    </div>
    </div>
    {% endif %}
    </div>
<center><div id="id_graph"></div></center>

{% if result %}
<script type="text/javascript">
    strName = '{{result.data.attributes.names|tojson}}'
    name = JSON.parse(strName)
    console.log(name)
    var array = name.split(',')
    for(var i=0; i< array.length; i++){
        console.log(array[i])
        document.getElementById("name").innerHTML += "<tr>" + "<td>" + array[i] + "</tr>" + "</td>"
    }
</script>
{% endif %}
<!-- /Header -->
{% if prediction %}
<script type="text/javascript">
    var prediction = '{{prediction}}'
        if (prediction == "malicious") {
          document.getElementById("malicious").innerHTML = "This software is malicious"
        }else{
          document.getElementById("legitimate").innerHTML = "This software is legitimate"
        }
</script>
{% endif %}
<!-- jQuery Plugins -->
<script type="text/javascript" src="./static/js/jquery.min.js"></script>
<script type="text/javascript" src="./static/js/bootstrap.min.js"></script>
<script type="text/javascript" src="./static/js//owl.carousel.min.js"></script>
<script type="text/javascript" src="./static/js/jquery.magnific-popup.js"></script>
<script type="text/javascript" src="./static/js/main.js"></script>
<script type="text/javascript" src="./static/js/index.js"></script>
</body>

</html>